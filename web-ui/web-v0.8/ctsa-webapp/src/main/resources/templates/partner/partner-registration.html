<!doctype html>
<html>

<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible"
          content="IE=edge">
    <title>Đăng kí tuyển dụng</title>
    <meta name="viewport"
          content="width=device-width, initial-scale=1">


    <!-- Bootstrap -->
    <link rel="stylesheet"
          href="https://maxcdn.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css">

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>

    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js"></script>
    <!-- <link href="https://fonts.googleapis.com/css?family=Muli" rel="stylesheet">  -->
    <link href="https://fonts.googleapis.com/css?family=Open+Sans"
          rel="stylesheet">
    <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css"
          rel="stylesheet">
    <link rel="stylesheet"
          href=".\css\style.css">
    <link rel="stylesheet"
          href=".\css\partner-registration.css">

    <style>

    </style>

    <link href="assets/css/style.css"
          rel="stylesheet">

    <script type="text/javascript"
            src="assets/js/vendor.js"></script>
    <script type="text/javascript"
            src="assets/js/bundle.js"></script>
</head>

<body class="app">
    <div id="loader">
        <div class="spinner"></div>
    </div>
    <script>
        $(window).ready(function () {
            $('#loader').hide();
        });
    </script>
    <nav class="navbar navbar-expand-md navbar-dark bg-dark"
         style="height: 45px">
        <a class="navbar-brand"
           href=".\index.html">
            <img src="https://res.cloudinary.com/ctsa-capstone/image/upload/v1541237101/demo-image/logoctsa.png"
                 width="90"
                 height="30"
                 class="d-inline-block align-top"
                 alt="CTSA logo">
        </a>

        <div class="collapse navbar-collapse justify-content-center menu "
             id="navbarSupportedContent">
            <a class="mx-5"
               href="#">Tuyển Dụng</a>
            <a class="mx-5"
               href=".\graph.html">Thống Kê</a>
            <a class="mx-5"
               href="#">Tuyển Dụng</a>
            <a class="mx-5"
               href="#">Thống Kê</a>

        </div>
        <span class="fa-stack">
            <i class="	fa fa-user-circle-o fa-stack-1x"
               style="font-size:36px; color:white"></i>
        </span>
    </nav>
    <!-- End of Header -->


    <div>


        <div class="container-fluid">
            <div id="content"
                 class="tab-content col-md-12 folder">

                <h3 class="c-grey-900">Partner Registration</h3>
                <div class="mT-30">
                    <form>
                        <div class="form-group">
                            <label class="font-weight-bold"
                                   for="partner-name">Company Name</label>
                            <input type="text"
                                   class="form-control"
                                   id="partner-name"
                                   placeholder="Company Name">
                        </div>

                        <div class="form-group">
                            <label class="font-weight-bold"
                                   for="partner-description">Introduction</label>
                            <textarea class="form-control"
                                      rows="5"
                                      id="partner-description"></textarea>
                        </div>

                        <div class="form-row">
                            <div class="form-group col">
                                <label class="font-weight-bold"
                                       for="partner-email">Email</label>
                                <input type="email"
                                       class="form-control"
                                       id="partner-email"
                                       placeholder="Email">
                            </div>

                            <div class="form-group col-md-4">
                                <label class="font-weight-bold"
                                       for="partner-phone">Phone</label>
                                <input type="text"
                                       class="form-control"
                                       id="partner-phone"
                                       placeholder="Phone"
                                       pattern="^(?:0|\(?\+[0-9]{2}\)?\s?)[0-9]{3}(\s)?[0-9]{3}(\s)?[0-9]{3,4}$"
                                       title="Example: 098 187 5110, (+84) 981875110">
                            </div>
                        </div>

                        <div class="form-group">
                            <label class="font-weight-bold"
                                   for="partner-address">Address</label>
                            <input type="text"
                                   class="form-control"
                                   id="partner-address"
                                   placeholder="Address">
                        </div>

                        <div class="form-group">
                            <label class="font-weight-bold"
                                   for="partner-logo">Logo</label>
                            <input type="file"
                                   class="form-control-file"
                                   id="partner-logo"
                                   accept="image/jpeg">
                        </div>

                        <div id="fields">
                            <input type="hidden"
                                   value="1"
                                   id="counter">
                            <label class="font-weight-bold">Additional Information</label>
                            <button type="button"
                                    class="btn btn-sm bg-orange text-white"
                                    onclick="addField()">Add Field</button>
                            <button type="button"
                                    class="btn btn-sm"
                                    onclick="removeField()">Remove
                                Field</button>
                            <br>
                            <br>
                            <div class="form-row">
                                <div class="form-group col-md-4">
                                    <input type="text"
                                           class="form-control"
                                           id="field-title"
                                           placeholder="Title">
                                </div>
                                <div class="form-group col-md-2">:
                                </div>
                                <div class="form-group col-md-6">
                                    <input type="text"
                                           class="form-control"
                                           id="field-info"
                                           placeholder="Information">
                                </div>
                            </div>
                        </div>
                        <hr>
                        <button type="button"
                                class="btn btn-lg bg-orange text-white"
                                onclick="submitForm()">Register</button>
                    </form>
                </div>
            </div>
        </div>
    </div>



    <script src="https://cdnjs.cloudflare.com/ajax/libs/axios/0.18.0/axios.min.js"></script>
    <script src="https://ajax.aspnetcdn.com/ajax/jQuery/jquery-3.3.1.min.js"></script>
    <script>
        var counter = $('#counter').val();

        function getAdditionalInformation() {
            var addition = {};
            addition[$('#field-title').val()] = $('#field-info').val();

            var i;
            for (i = 1; i < counter; i++) {
                addition[$('#field-title' + i).val()] = $('#field-info' + i).val();
            }

            return JSON.stringify(addition);
        }

        function addField() {
            if (counter > 10) {
                alert("Reached the maximum number of fields allowed.");
                return false;
            }

            var newField = '<div class="form-row field' + counter + '">'
                + '<div class="form-group col-md-4"><input type="text" class="form-control" id="field-title' + counter + '" placeholder="Title"></div>'
                + '<div class="form-group col-md-2">:</div>'
                + '<div class="form-group col-md-6"><input type="text" class="form-control" id="field-info' + counter + '" placeholder="Information"></div>'
                + '</div>';

            $('#fields').append(newField);

            counter++;
        }

        function removeField() {
            if (counter == 1) {
                alert("No more field to remove.");
                return false;
            }

            counter--;

            $(".field" + counter).remove();
        }

        function submitForm() {
            var partner = {
                name: $('#partner-name').val(),
                description: $('#partner-description').val(),
                logo: '',
                email: $('#partner-email').val(),
                phone: $('#partner-phone').val(),
                address: $('#partner-address').val(),
                additionalInformation: getAdditionalInformation()
            }

            console.log(partner);

            var logo = document.getElementById('partner-logo').files[0];

            var formData = new FormData();
            formData.append('partner', JSON.stringify(partner));
            formData.append('file', logo);

            axios.post('http://localhost:8080/companies', formData, {
                headers: {
                    'Content-Type': `multipart/form-data; boundary=${
                        formData._boundary
                        }`
                }
            }).then((response) => {
                console.log(response);
            })
        }
    </script>
</body>

</html>